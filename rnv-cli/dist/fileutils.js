var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.cleanFolder=exports.copyFolderContentsRecursiveSync=exports.mkdirSync=exports.saveAsJs=exports.removeDir=exports.copyFolderRecursiveSync=exports.copyFileSync=void 0;var _fs=_interopRequireDefault(require("fs"));var _path=_interopRequireDefault(require("path"));var _rimraf=_interopRequireDefault(require("rimraf"));var _svg2js=_interopRequireDefault(require("svg2js"));var _shelljs=_interopRequireDefault(require("shelljs"));var _common=require("./common");var copyFileSync=function copyFileSync(source,target){(0,_common.logDebug)('copyFileSync',source,target);var targetFile=target;if(source.indexOf('.DS_Store')!==-1)return;if(_fs.default.existsSync(target)){if(_fs.default.lstatSync(target).isDirectory()){targetFile=_path.default.join(target,_path.default.basename(source));}}_fs.default.writeFileSync(targetFile,_fs.default.readFileSync(source));};exports.copyFileSync=copyFileSync;var copyFolderRecursiveSync=function copyFolderRecursiveSync(source,target){var convertSvg=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var skipPaths=arguments.length>3?arguments[3]:undefined;(0,_common.logDebug)('copyFolderRecursiveSync',source,target);if(!_fs.default.existsSync(source))return;var files=[];var targetFolder=_path.default.join(target,_path.default.basename(source));if(!_fs.default.existsSync(targetFolder)){mkdirSync(targetFolder);}if(_fs.default.lstatSync(source).isDirectory()){files=_fs.default.readdirSync(source);files.forEach(function(file){var curSource=_path.default.join(source,file);if(_fs.default.lstatSync(curSource).isDirectory()){copyFolderRecursiveSync(curSource,targetFolder);}else if(_path.default.extname(curSource)==='.svg'&&convertSvg===true){var jsDest=_path.default.join(targetFolder,_path.default.basename(curSource)+".js");(0,_common.logDebug)("file "+curSource+" is svg and convertSvg is set to true. converitng to "+jsDest);saveAsJs(curSource,jsDest);}else{copyFileSync(curSource,targetFolder);}});}};exports.copyFolderRecursiveSync=copyFolderRecursiveSync;var copyFolderContentsRecursiveSync=function copyFolderContentsRecursiveSync(source,target){var convertSvg=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var skipPaths=arguments.length>3?arguments[3]:undefined;(0,_common.logDebug)('copyFolderContentsRecursiveSync',source,target,skipPaths);if(!_fs.default.existsSync(source))return;var files=[];var targetFolder=_path.default.join(target);if(!_fs.default.existsSync(targetFolder)){mkdirSync(targetFolder);}if(_fs.default.lstatSync(source).isDirectory()){files=_fs.default.readdirSync(source);files.forEach(function(file){var curSource=_path.default.join(source,file);if(!skipPaths||skipPaths&&!skipPaths.includes(curSource)){if(_fs.default.lstatSync(curSource).isDirectory()){copyFolderRecursiveSync(curSource,targetFolder,convertSvg,skipPaths);}else{copyFileSync(curSource,targetFolder);}}});}};exports.copyFolderContentsRecursiveSync=copyFolderContentsRecursiveSync;var saveAsJs=function saveAsJs(source,dest){_svg2js.default.createSync({source:source,destination:dest});};exports.saveAsJs=saveAsJs;var removeDir=function removeDir(path,callback){(0,_rimraf.default)(path,callback);};exports.removeDir=removeDir;var mkdirSync=function mkdirSync(dir){_shelljs.default.mkdir('-p',dir);};exports.mkdirSync=mkdirSync;var cleanFolder=function cleanFolder(d){return new Promise(function(resolve,reject){(0,_common.logDebug)('cleanFolder',d);removeDir(d,function(){mkdirSync(d);resolve();});});};exports.cleanFolder=cleanFolder;var _default={copyFileSync:copyFileSync,copyFolderRecursiveSync:copyFolderRecursiveSync,removeDir:removeDir,saveAsJs:saveAsJs,mkdirSync:mkdirSync,copyFolderContentsRecursiveSync:copyFolderContentsRecursiveSync,cleanFolder:cleanFolder};exports.default=_default;